<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Pre-Resoluciones - Municipalidad</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ›ï¸ Sistema de Pre-Resoluciones</h1>
            <p>Municipalidad Distrital - GestiÃ³n de Expedientes y Resoluciones</p>
        </div>
        
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('inicio')">ğŸ“Š INICIO</button>
            <button class="nav-tab" onclick="showTab('administrados')">ğŸ‘¥ Administrados</button>
            <button class="nav-tab" onclick="showTab('expedientes')">ğŸ“ Expedientes</button>
            <button class="nav-tab" onclick="showTab('proveidos')">ğŸ“‹ ProveÃ­dos</button>
            <button class="nav-tab" onclick="showTab('preresoluciones')">âš–ï¸ Pre-Resoluciones</button>
            <button class="nav-tab" onclick="showTab('consultas')">ğŸ” Consultas Avanzadas</button>
            <button class="nav-tab" onclick="showTab('nuevo')">â• Nuevo Documento</button>
        </div>
        
        <!-- DASHBOARD -->
        <div id="inicio" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="total-expedientes">0</div>
                    <div class="stat-label">Expedientes Activos</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="total-proveidos">0</div>
                    <div class="stat-label">ProveÃ­dos Generados</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="total-preresoluciones">0</div>
                    <div class="stat-label">Pre-Resoluciones</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="pendientes">0</div>
                    <div class="stat-label">Pendientes de RevisiÃ³n</div>
                </div>
            </div>
            
            <div class="card">
                <h3>ğŸ“ˆ Resumen del Sistema</h3>
                <p>Bienvenido al Sistema de Pre-Resoluciones Municipal. Desde aquÃ­ puedes gestionar expedientes, proveÃ­dos y pre-resoluciones de manera eficiente.</p>
                <div class="quick-actions">
                    <button class="btn" onclick="showTab('administrados')">ğŸ‘¤ Gestionar Administrados</button>
                    <button class="btn" onclick="showTab('nuevo')">ğŸ“ Crear Nuevo Documento</button>
                    <button class="btn" onclick="showTab('consultas')">ğŸ” Ejecutar Consultas</button>
                </div>
            </div>
        </div>
        
        <!-- ADMINISTRADOS -->
        <div id="administrados" class="tab-content">
            <div class="card">
                <h3>ğŸ‘¥ GestiÃ³n de Administrados</h3>
                <div class="filtros">
                    <input type="text" id="filtro-administrado" placeholder="ğŸ” Buscar administrado..." onkeyup="filtrarAdministrados()">
                </div>
                <table id="tabla-administrados">
                    <thead>
                        <tr>
                            <th>DNI/RUC</th>
                            <th>Nombre</th>
                            <th>DirecciÃ³n</th>
                            <th>UrbanizaciÃ³n</th>
                            <th>Ciudad</th>
                            <th>Calle</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="cuerpo-administrados">
                    </tbody>
                </table>
            </div>

            <div class="card">
                <h3>ğŸ“ Solicitudes de Administrados</h3>
                <div class="filtros">
                    <input type="text" id="filtro-solicitud" placeholder="ğŸ” Buscar solicitud..." onkeyup="filtrarSolicitudes()">
                </div>
                <table id="tabla-solicitudes">
                    <thead>
                        <tr>
                            <th>NÂ° Solicitud</th>
                            <th>Administrado</th>
                            <th>TÃ­tulo</th>
                            <th>Fecha</th>
                            <th>Estado</th>
                            <th>Expediente</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="cuerpo-solicitudes">
                    </tbody>
                </table>
            </div>

            <div class="form-row">
                <div class="card" style="flex: 1;">
                    <h3>ğŸ‘¤ Agregar Nuevo Administrado</h3>
                    <form id="form-administrado" onsubmit="agregarAdministrado(event)">
                        <div class="form-group">
                            <label for="d_r">DNI/RUC:</label>
                            <input type="text" id="d_r" name="d_r" required maxlength="11" placeholder="Ej: 71584562101">
                        </div>
                        <div class="form-group">
                            <label for="noma">Nombre Completo:</label>
                            <input type="text" id="noma" name="noma" required placeholder="Ej: Juan Perez Rios">
                        </div>
                        <div class="form-group">
                            <label for="dir_d">DirecciÃ³n:</label>
                            <input type="text" id="dir_d" name="dir_d" required placeholder="Ej: Av. Peru 123">
                        </div>
                        <div class="form-group">
                            <label for="dir_a">UrbanizaciÃ³n:</label>
                            <input type="text" id="dir_a" name="dir_a" required placeholder="Ej: Cercado">
                        </div>
                        <div class="form-group">
                            <label for="dir_c">Ciudad:</label>
                            <input type="text" id="dir_c" name="dir_c" required value="Arequipa">
                        </div>
                        <div class="form-group">
                            <label for="dir_n">Calle/Jr/Av:</label>
                            <input type="text" id="dir_n" name="dir_n" required placeholder="Ej: Calle A">
                        </div>
                        <button type="submit" class="btn btn-success">â• Agregar Administrado</button>
                    </form>
                </div>

                <div class="card" style="flex: 1;">
                    <h3>ğŸ“„ Generar Nueva Solicitud</h3>
                    <form id="form-solicitud" onsubmit="agregarSolicitud(event)">
                        <div class="form-group">
                            <label for="administrado-solicitud">Administrado:</label>
                            <select id="administrado-solicitud" required>
                                <option value="">Seleccionar administrado...</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="mesa-partes">Mesa de Partes:</label>
                            <select id="mesa-partes" required>
                                <option value="">Seleccionar mesa de partes...</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="tita-solicitud">TÃ­tulo de Solicitud:</label>
                            <input type="text" id="tita-solicitud" required placeholder="Ej: Licencia de ConstrucciÃ³n">
                        </div>
                        <div class="form-group">
                            <label for="asnt-solicitud">Asunto Detallado:</label>
                            <textarea id="asnt-solicitud" required placeholder="Describa detalladamente el motivo de la solicitud..." rows="4"></textarea>
                        </div>
                        <button type="submit" class="btn btn-success">ğŸ“„ Generar Solicitud y Expediente</button>
                    </form>
                </div>
            </div>
        </div>
        
        <!-- EXPEDIENTES -->
        <div id="expedientes" class="tab-content">
            <div class="card">
                <h3>ğŸ“‚ Lista de Expedientes</h3>
                <div class="filtros">
                    <input type="text" id="filtro-expediente" placeholder="ğŸ” Buscar expediente..." onkeyup="filtrarExpedientes()">
                    <select id="filtro-estado-expediente" onchange="filtrarExpedientes()">
                        <option value="">Todos los estados</option>
                        <option value="En revision">En revisiÃ³n</option>
                        <option value="Aprobado">Aprobado</option>
                        <option value="Observado">Observado</option>
                        <option value="Pendiente">Pendiente</option>
                    </select>
                </div>
                <table id="tabla-expedientes">
                    <thead>
                        <tr>
                            <th>NÂ° Expediente</th>
                            <th>Fecha</th>
                            <th>Estado</th>
                            <th>Responsable</th>
                            <th>Asunto</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="cuerpo-expedientes">
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- PROVEÃDOS -->
        <div id="proveidos" class="tab-content">
            <div class="card">
                <h3>ğŸ“‹ ProveÃ­dos Generados</h3>
                <div class="filtros">
                    <input type="text" id="filtro-proveido" placeholder="ğŸ” Buscar proveÃ­do..." onkeyup="filtrarProveidos()">
                </div>
                <table id="tabla-proveidos">
                    <thead>
                        <tr>
                            <th>NÂ° ProveÃ­do</th>
                            <th>Fecha</th>
                            <th>Expediente</th>
                            <th>InstrucciÃ³n</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="cuerpo-proveidos">
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- PRE-RESOLUCIONES -->
        <div id="preresoluciones" class="tab-content">
            <div class="card">
                <h3>âš–ï¸ Pre-Resoluciones</h3>
                <div class="filtros">
                    <input type="text" id="filtro-preresolucion" placeholder="ğŸ” Buscar pre-resoluciÃ³n..." onkeyup="filtrarPreResoluciones()">
                    <select id="filtro-estado-preresolucion" onchange="filtrarPreResoluciones()">
                        <option value="">Todos los estados</option>
                        <option value="Aprobado">Aprobado</option>
                        <option value="Observado">Observado</option>
                        <option value="Rechazado">Rechazado</option>
                        <option value="Pendiente">Pendiente</option>
                    </select>
                </div>
                <table id="tabla-preresoluciones">
                    <thead>
                        <tr>
                            <th>NÂ° Pre-ResoluciÃ³n</th>
                            <th>Fecha</th>
                            <th>Estado</th>
                            <th>Expediente</th>
                            <th>Analista</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="cuerpo-preresoluciones">
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- CONSULTAS AVANZADAS -->
        <div id="consultas" class="tab-content">
            <div class="card">
                <h3>ğŸ” Consultas Avanzadas</h3>
                <div class="consultas-grid">
                    <div class="consulta-item" onclick="ejecutarConsulta('fecha_preresolucion_numero')">
                        <div class="consulta-icon">ğŸ“…</div>
                        <div class="consulta-info">
                            <h4>Fechas de Pre-Resoluciones</h4>
                            <p>NÃºmero y fecha de emisiÃ³n de pre-resoluciones</p>
                        </div>
                    </div>
                    
                    <div class="consulta-item" onclick="ejecutarConsulta('encargados_fecha_preresolucion')">
                        <div class="consulta-icon">ğŸ‘¤</div>
                        <div class="consulta-info">
                            <h4>Analistas y Fechas</h4>
                            <p>Pre-resoluciones con analistas responsables y fechas</p>
                        </div>
                    </div>
                    
                    <div class="consulta-item" onclick="ejecutarConsulta('fecha_mesa_partes_solicitud')">
                        <div class="consulta-icon">ğŸ“‹</div>
                        <div class="consulta-info">
                            <h4>Fechas en Mesa de Partes</h4>
                            <p>Expedientes con fechas de ingreso por mesa de partes</p>
                        </div>
                    </div>
                    
                    <div class="consulta-item" onclick="ejecutarConsulta('preresolucion_ordenada_fecha_solicitud')">
                        <div class="consulta-icon">ğŸ“Š</div>
                        <div class="consulta-info">
                            <h4>Orden por Fecha Solicitud</h4>
                            <p>Pre-resoluciones ordenadas por fecha de presentaciÃ³n</p>
                        </div>
                    </div>
                    
                    <div class="consulta-item" onclick="ejecutarConsulta('preresoluciones_con_gerencia')">
                        <div class="consulta-icon">ğŸ¢</div>
                        <div class="consulta-info">
                            <h4>Pre-Resoluciones por Gerencia</h4>
                            <p>Pre-resoluciones agrupadas por gerencia responsable</p>
                        </div>
                    </div>
                    
                    <div class="consulta-item" onclick="ejecutarConsulta('solicitudes_estado_analista')">
                        <div class="consulta-icon">ğŸ“</div>
                        <div class="consulta-info">
                            <h4>Solicitudes y Estados</h4>
                            <p>Solicitudes con estado, expediente y analista</p>
                        </div>
                    </div>
                    
                    <div class="consulta-item" onclick="ejecutarConsulta('solicitudes_por_mesa_partes')">
                        <div class="consulta-icon">ğŸ“¦</div>
                        <div class="consulta-info">
                            <h4>Solicitudes por Mesa</h4>
                            <p>Cantidad de solicitudes por mesa de partes</p>
                        </div>
                    </div>
                    
                    <div class="consulta-item" onclick="ejecutarConsulta('preresoluciones_por_normativa')">
                        <div class="consulta-icon">âš–ï¸</div>
                        <div class="consulta-info">
                            <h4>Pre-Resoluciones por Normativa</h4>
                            <p>Pre-resoluciones y normativas aplicables</p>
                        </div>
                    </div>
                    
                    <div class="consulta-item" onclick="ejecutarConsulta('preresoluciones_por_mes_anio')">
                        <div class="consulta-icon">ğŸ“…</div>
                        <div class="consulta-info">
                            <h4>Pre-Resoluciones por Mes/AÃ±o</h4>
                            <p>Pre-resoluciones agrupadas por perÃ­odo</p>
                        </div>
                    </div>
                    
                    <div class="consulta-item" onclick="ejecutarConsulta('preresoluciones_pendientes_por_analista')">
                        <div class="consulta-icon">â³</div>
                        <div class="consulta-info">
                            <h4>Pendientes por Analista</h4>
                            <p>Pre-resoluciones pendientes por analista</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h3>ğŸ“Š Resultados de la Consulta</h3>
                <div class="filtros">
                    <input type="text" id="filtro-consulta" placeholder="ğŸ” Filtrar resultados..." onkeyup="filtrarResultadosConsulta()">
                </div>
                <div class="resultados-consulta" id="resultados-consulta">
                    <p class="placeholder">Seleccione una consulta para ver los resultados</p>
                </div>
            </div>
        </div>
        
        <!-- NUEVO DOCUMENTO -->
        <div id="nuevo" class="tab-content">
            <!-- Formulario de ProveÃ­do -->
            <div class="card">
                <h3>ğŸ“ Generar ProveÃ­do</h3>
                <form id="form-proveido" onsubmit="return crearProveido(event)">
                    <div class="form-group">
                        <label for="expediente-proveido">Expediente:</label>
                        <select id="expediente-proveido" name="nuex" required>
                            <option value="">Seleccionar expediente...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="instruccion">InstrucciÃ³n:</label>
                        <textarea id="instruccion" name="ints" required placeholder="Ingrese las instrucciones para este proveÃ­do..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="gerencia">Gerencia Destino:</label>
                        <select id="gerencia" name="idger" required>
                            <option value="">Seleccionar gerencia...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="subgerencia">Subgerencia Destino:</label>
                        <select id="subgerencia" name="nsub" required>
                            <option value="">Seleccionar subgerencia...</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-success">ğŸ’¾ Guardar ProveÃ­do</button>
                </form>
            </div>

            <!-- Formulario de Pre-ResoluciÃ³n -->
            <div class="card">
                <h3>âš–ï¸ Generar Pre-ResoluciÃ³n</h3>
                <form id="form-preresolucion" onsubmit="return crearPreResolucion(event)">
                    <div class="form-group">
                        <label for="expediente-preresolucion">Expediente:</label>
                        <select id="expediente-preresolucion" name="nuex" required>
                            <option value="">Seleccionar expediente...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="estado">Estado:</label>
                        <select id="estado" name="estd" required>
                            <option value="">Seleccionar estado...</option>
                            <option value="Aprobado">Aprobado</option>
                            <option value="Observado">Observado</option>
                            <option value="Rechazado">Rechazado</option>
                            <option value="Pendiente">Pendiente</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="fundamento-hecho">Fundamento de Hecho:</label>
                        <textarea id="fundamento-hecho" name="fuhe" required placeholder="Describa los hechos..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="fundamento-derecho">Fundamento de Derecho:</label>
                        <textarea id="fundamento-derecho" name="fude" required placeholder="Describa el fundamento legal..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="analista">Analista Responsable:</label>
                        <select id="analista" name="dnia" required>
                            <option value="">Seleccionar analista...</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-success">ğŸ’¾ Guardar Pre-ResoluciÃ³n</button>
                </form>
            </div>
        </div>
    </div>

    <script src="/static/script_backup.js"></script>
</body>
</html>
